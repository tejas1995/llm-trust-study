(()=>{"use strict";var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{o:()=>i});let t="https://tejassrinivasan.pythonanywhere.com/";var i=!1,n=[];let o,a,r=-1,s=null,l=!1,c=!1,d=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],_=0,u=-1,b=-1,m=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],p=-1,g=0,v=0;function h(e){if(-1!=p)return;const t=document.getElementById(`source_${e}_span`);t&&(t.style.display="block");const i=document.getElementById(`source_${e}_dropbtn`);i&&(i.className="arrow down"),d[e]=!0,m[e]=Date.now()-a,$(`#source_${e}_titlebar`).attr("disabled","true"),$(`#source_${e}_titlebar`).attr("activedecision","true")}function w(e){if(-1!=r){o=!!e,s.gt_label==o&&(_+=.1),p=Date.now()-a,$("#ai_explanation_titlebar").attr("disabled","true"),$("#view_sources_titlebar").attr("disabled","true");for(let e=0;e<10;e++)$(`#source_${e}_titlebar`).attr("disabled","true");$("#button_next").show(),$("#button_next").removeAttr("disabled"),$("#button_user_decision_claimtrue").attr("disabled","true"),$("#button_user_decision_claimfalse").attr("disabled","true"),e?(o=!0,$("#button_user_decision_claimtrue").attr("activedecision","true")):(o=!1,$("#button_user_decision_claimfalse").attr("activedecision","true"))}}function y(e){g+=e,0==g?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),g>=6?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),7==g&&($("#main_box_instructions").hide(),$("#main_box_experiment").show(),f()),$("#main_box_instructions").children(":not(input)").each(((e,t)=>{$(t).hide()})),$(`#instructions_${g}`).show()}function f(){$("#button_user_decision_claimtrue").removeAttr("activedecision"),$("#button_user_decision_claimfalse").removeAttr("activedecision"),$("#button_user_decision_claimtrue").removeAttr("disabled"),$("#button_user_decision_claimfalse").removeAttr("disabled"),$("#ai_explanation_dropbtn").removeAttr("disabled"),$("#ai_explanation_dropbtn").removeAttr("activedecision"),$("#ai_explanation_dropbtn").attr("class","arrow right"),$("#ai_explanation_titlebar").removeAttr("disabled"),$("#ai_explanation_titlebar").removeAttr("activedecision"),$("#ai_explanation_dropdown").hide(),$("#view_sources_dropbtn").removeAttr("disabled"),$("#view_sources_dropbtn").removeAttr("activedecision"),$("#view_sources_dropbtn").attr("class","arrow right"),$("#view_sources_titlebar").removeAttr("disabled"),$("#view_sources_titlebar").removeAttr("activedecision"),$("#all_sources_div").hide();for(let e=0;e<10;e++)$(`#source_${e}_span`).hide(),$(`#source_${e}_dropbtn`).removeAttr("disabled"),$(`#source_${e}_dropbtn`).removeAttr("activedecision"),$(`#source_${e}_dropbtn`).attr("class","arrow right"),$(`#source_${e}_titlebar`).removeAttr("disabled"),$(`#source_${e}_titlebar`).removeAttr("activedecision");if(l=!1,c=!1,d=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],u=-1,b=-1,m=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],p=-1,$("#button_next").hide(),r+=1,r>=n.length)return $("#main_box_experiment").hide(),void(i?$("#main_box_end_mock").show():$("#main_box_end").show());s=n[r],$("#claim_span").html(s.claim);let e=s.llm_prediction?"The claim is true.":"The claim is false.";$("#ai_prediction_span").html(e),$("#ai_confidence_span").html(s.llm_confidence),$("#ai_explanation_span").html(s.llm_explanation);for(let e=0;e<s.sources.length;e++)$(`#source_${e}_span`).html(s.sources[e]);a=Date.now(),$("#progress").text(`Progress: ${r+1} / ${n.length}`)}document.getElementById("ai_explanation_titlebar")?.addEventListener("click",(function(){if(-1!=p)return;const e=document.getElementById("ai_explanation_dropdown");e&&(e.style.display="block");const t=document.getElementById("ai_explanation_dropbtn");t&&(t.className="arrow vanish"),l=!0,u=Date.now()-a,$("#ai_explanation_titlebar").attr("disabled","true"),$("#ai_explanation_titlebar").attr("activedecision","true")})),document.getElementById("view_sources_titlebar")?.addEventListener("click",(function(){if(-1!=p)return;const e=document.getElementById("all_sources_div");e&&(e.style.display="block");const t=document.getElementById("view_sources_dropbtn");t&&(t.className="arrow vanish"),c=!0,b=Date.now()-a,$("#view_sources_titlebar").attr("disabled","true"),$("#view_sources_titlebar").attr("activedecision","true")})),document.getElementById("source_0_titlebar")?.addEventListener("click",(()=>h(0))),document.getElementById("source_1_titlebar")?.addEventListener("click",(()=>h(1))),document.getElementById("source_2_titlebar")?.addEventListener("click",(()=>h(2))),document.getElementById("source_3_titlebar")?.addEventListener("click",(()=>h(3))),document.getElementById("source_4_titlebar")?.addEventListener("click",(()=>h(4))),document.getElementById("source_5_titlebar")?.addEventListener("click",(()=>h(5))),document.getElementById("source_6_titlebar")?.addEventListener("click",(()=>h(6))),document.getElementById("source_7_titlebar")?.addEventListener("click",(()=>h(7))),document.getElementById("source_8_titlebar")?.addEventListener("click",(()=>h(8))),document.getElementById("source_9_titlebar")?.addEventListener("click",(()=>h(9))),$("#button_user_decision_claimtrue").on("click",(()=>w(!0))),$("#button_user_decision_claimfalse").on("click",(()=>w(!1))),$("#button_instructions_next").on("click",(()=>y(1))),$("#button_instructions_prev").on("click",(()=>y(-1))),$("#button_next").on("click",(()=>{if(-1!=r){let e={question_i:r,user_balance_post_interaction:_,final_user_decision:o,accessed_explanation:l,accessed_sources:c,accessed_individual_source:d};e.times={access_explanation:u,access_sources:b,access_individual_source:m,final_decision:p},e.question=s,e.count_exited_page=v,async function(e){if(i)console.log("logged (mock)",e);else{e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="trialrun_studies"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let i=await $.ajax(t+"log",{data:JSON.stringify({project:"llm-trust-study/"+e.url_data.study_id,uid:globalThis.uid+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((e=>setTimeout(e,2e3)))}(),i}catch(e){console.log(e)}}}(e),v=0}f()}));const x=new URLSearchParams(window.location.search),E=x.get("start"),k=x.get("uid");if(globalThis.url_data=function(e){const t={};for(const[i,n]of e)t[i]=n;return t}(x.entries()),null!=k){if(globalThis.uid=k,"prolific_random"==globalThis.uid){let e=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${x.get("prolific_queue_name")}_${e}`}}else{let e=null;for(;null==e;)e=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=e}globalThis.uid.startsWith("demo_paper")&&(i=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((e=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((e=>{n=e,null!=E&&(r=parseInt(E)-1,console.log("Starting from",r)),y(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let I=!1;document.onvisibilitychange=()=>{I||(v+=1,I=!0,I=!1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPdEIsQ0FDVCxDRGlWc0J1QixDQUFlVCxFQUFVTyxXQUU3QixNQUFkRCxHQUVBLEdBREF2QixXQUFXRSxJQUFNcUIsRUFDSyxtQkFBbEJ2QixXQUFXRSxJQUEwQixDQUNyQyxJQUFJeUIsRUFBVyxHQUFHQyxLQUFLQyxNQUFzQixHQUFoQkQsS0FBS0UsWUFBaUJDLFNBQVMsRUFBRyxLQUMvRC9CLFdBQVdFLElBQU0sR0FBR2UsRUFBVTdFLElBQUksMEJBQTBCdUYsRyxNQUk3RCxDQUNILElBQUlLLEVBQWlCLEtBQ3JCLEtBQW9CLE1BQWJBLEdBQ0hBLEVBQVlDLE9BQU8sc0hBRXZCakMsV0FBV0UsSUFBTThCLEMsQ0FJakJoQyxXQUFXRSxJQUFJZ0MsV0FBVyxnQkFDMUJ2RixHQUFXLEdBSWZtRCxRQUFRQyxJQUFJLG1CQUFvQkMsV0FBV0UsS0R2V3BDTCxpQkFLSCxhQUhtQnZCLEVBQUU2RCxRQUNqQixnQkFBZ0JuQyxXQUFXRSxjQUFjOUIsS0FBS0MsUUFHdEQsQ0NrV0ErRCxHQUFZQyxPQUFPQyxJQUVmeEMsUUFBUUMsSUFBSSxvQkFDWkQsUUFBUUMsSUFBSUMsV0FBV0UsS0FDdkJpQixPQUFPQyxTQUFTbUIsUUFBUSxJQUUxQkMsTUFBTUMsSUFDSjdGLEVBQU82RixFQUNjLE1BQWpCbkIsSUFDQXZFLEVBQWEyRixTQUFTcEIsR0FBaUIsRUFDdkN4QixRQUFRQyxJQUFJLGdCQUFpQmhELElBR2pDNkIsRUFBa0IsR0FDbEJOLEVBQUUsMEJBQTBCSSxPQUM1QkosRUFBRSxpQ0FBaUNTLE1BQU0sSUFHN0NlLFFBQVFDLElBQUksNkJBQThCQyxXQUFXRSxLQUVyRCxJQUFJeUMsR0FBZSxFQUNuQjdFLFNBQVM4RSxtQkFBcUIsS0FDckJELElBQ0RqRixHQUFxQixFQUNyQmlGLEdBQWUsRUFJZkEsR0FBZSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyBERVZNT0RFIH0gZnJvbSAnLi9nbG9iYWxzJ1xuaW1wb3J0IHsgTU9DS01PREUgfSBmcm9tICcuL21haW4nXG5cbmxldCBTRVJWRVJfTE9HX1JPT1QgPSBERVZNT0RFID8gXCJodHRwOi8vMTI3LjAuMC4xOjUwMDAvXCIgOiBcImh0dHBzOi8vdGVqYXNzcmluaXZhc2FuLnB5dGhvbmFueXdoZXJlLmNvbS9cIlxuXG5hc3luYyBmdW5jdGlvbiBzbGVlcChtczogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2RhdGEoKTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBpbmNsdWRlIHRpbWVzdGFtcCBzbyB0aGF0IHRoaW5ncyBkb24ndCBnZXQgY2FjaGVkXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0ICQuZ2V0SlNPTihcbiAgICAgICAgYGJha2VkX3F1ZXVlcy8ke2dsb2JhbFRoaXMudWlkfS5qc29uP3Q9JHtEYXRlLm5vdygpfWAsXG4gICAgKVxuICAgIHJldHVybiByZXN1bHRcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dfZGF0YShkYXRhKTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoTU9DS01PREUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJsb2dnZWQgKG1vY2spXCIsIGRhdGEpXG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBcbiAgICBkYXRhW1widXJsX2RhdGFcIl0gPSBnbG9iYWxUaGlzLnVybF9kYXRhXG4gICAgY29uc29sZS5sb2coXCJEYXRhXCIpXG4gICAgaWYgKCEoXCJzdHVkeV9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJzdHVkeV9pZFwiXSA9IFwidHJpYWxydW5fc3R1ZGllc1wiXG4gICAgfVxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXVtcInF1ZXVlX2lkXCJdID0gZ2xvYmFsVGhpcy51aWRcbiAgICBjb25zb2xlLmxvZyhcImxvZ2dlZFwiLCBkYXRhKVxuICAgIGNvbnNvbGUubG9nKFwiTG9nZ2luZyB0b1wiLCBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiKVxuXG4gICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0ICQuYWpheChcbiAgICAgICAgICAgIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcImxsbS10cnVzdC1zdHVkeS9cIitkYXRhWyd1cmxfZGF0YSddWydzdHVkeV9pZCddLFxuICAgICAgICAgICAgICAgICAgICB1aWQ6IGdsb2JhbFRoaXMudWlkK1wiX1wiK2RhdGFbJ3VybF9kYXRhJ11bJ3Byb2xpZmljX2lkJ10sXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgICAgIGF3YWl0IHNsZWVwKDIwMDApO1xuICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgIH1cbn0iLCJpbXBvcnQgeyBERVZNT0RFIH0gZnJvbSBcIi4vZ2xvYmFsc1wiXG5leHBvcnQgdmFyIFVJRDogc3RyaW5nXG5leHBvcnQgdmFyIE1PQ0tNT0RFOiBib29sZWFuID0gZmFsc2VcbmltcG9ydCB7IGxvYWRfZGF0YSwgbG9nX2RhdGEgfSBmcm9tICcuL2Nvbm5lY3RvcidcbmltcG9ydCB7IHBhcmFtc1RvT2JqZWN0IH0gZnJvbSBcIi4vdXRpbHNcIlxuXG52YXIgZGF0YTogYW55W10gPSBbXVxubGV0IHF1ZXN0aW9uX2kgPSAtMVxubGV0IHF1ZXN0aW9uOiBhbnkgPSBudWxsXG5sZXQgZmluYWxfdXNlcl9kZWNpc2lvbjogYm9vbGVhblxubGV0IGFjY2Vzc2VkX2V4cGxhbmF0aW9uOiBib29sZWFuID0gZmFsc2VcbmxldCBhY2Nlc3NlZF9zb3VyY2VzOiBib29sZWFuID0gZmFsc2VcbmxldCBhY2Nlc3NlZF9pbmRpdmlkdWFsX3NvdXJjZTogYW55W10gPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdXG5sZXQgYmFsYW5jZSA9IDBcbmxldCB0aW1lX3F1ZXN0aW9uX3N0YXJ0OiBudW1iZXJcbmxldCB0aW1lX3RvX2FjY2Vzc19leHBsYW5hdGlvbjogbnVtYmVyID0gLTFcbmxldCB0aW1lX3RvX2FjY2Vzc19zb3VyY2VzOiBudW1iZXIgPSAtMVxubGV0IHRpbWVfdG9fYWNjZXNzX2luZGl2aWR1YWxfc291cmNlOiBhbnlbXSA9IFstMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMV1cbmxldCB0aW1lX2ZpbmFsX2RlY2lzaW9uOiBudW1iZXIgPSAtMVxubGV0IGluc3RydWN0aW9uX2k6IG51bWJlciA9IDBcbmxldCBjb3VudF9leGl0ZWRfcGFnZTogbnVtYmVyID0gMFxuXG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtZXNzYWdlKSB7XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgdGhyb3cgbWVzc2FnZSB8fCBcIkFzc2VydGlvbiBmYWlsZWRcIjtcbiAgICB9XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHRvZ2dsZSB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgZGl2IGVsZW1lbnRcbmZ1bmN0aW9uIHNob3dFeHBsYW5hdGlvbigpIHtcbiAgICBpZiAodGltZV9maW5hbF9kZWNpc2lvbiAhPSAtMSkge1xuICAgICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGRpdiBlbGVtZW50IGJ5IGl0cyBJRFxuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhaV9leHBsYW5hdGlvbl9kcm9wZG93bicpO1xuICAgIGlmIChkaXYpIHtcbiAgICAgICAgLy8gVG9nZ2xlIHRoZSB2aXNpYmlsaXR5XG4gICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB9XG4gICAgY29uc3QgYnV0dG9uX2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhaV9leHBsYW5hdGlvbl9kcm9wYnRuJyk7XG4gICAgaWYgKGJ1dHRvbl9kaXYpIHtcbiAgICAgICAgLy9DaGFuZ2UgdGhlIGNsYXNzIHRvIGFycm93IGRvd25cbiAgICAgICAgYnV0dG9uX2Rpdi5jbGFzc05hbWUgPSAnYXJyb3cgdmFuaXNoJztcbiAgICB9XG4gICAgYWNjZXNzZWRfZXhwbGFuYXRpb24gPSB0cnVlXG4gICAgdGltZV90b19hY2Nlc3NfZXhwbGFuYXRpb24gPSBEYXRlLm5vdygpIC0gdGltZV9xdWVzdGlvbl9zdGFydFxuXG4gICAgLy8kKFwiI2FpX2V4cGxhbmF0aW9uX2Ryb3Bkb3duXCIpLnRvZ2dsZSgpXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl90aXRsZWJhclwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl90aXRsZWJhclwiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gIH1cbiAgXG4vLyBFdmVudCBsaXN0ZW5lciBmb3IgdGhlIGJ1dHRvbiBjbGlja1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FpX2V4cGxhbmF0aW9uX3RpdGxlYmFyJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2hvd0V4cGxhbmF0aW9uKTtcblxuZnVuY3Rpb24gc2hvd0FsbFNvdXJjZXMoKSB7XG4gICAgaWYgKHRpbWVfZmluYWxfZGVjaXNpb24gIT0gLTEpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBkaXYgZWxlbWVudCBieSBpdHMgSURcbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWxsX3NvdXJjZXNfZGl2Jyk7XG4gICAgaWYgKGRpdikge1xuICAgICAgICAvLyBUb2dnbGUgdGhlIHZpc2liaWxpdHlcbiAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cbiAgICBjb25zdCBidXR0b25fZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdfc291cmNlc19kcm9wYnRuJyk7XG4gICAgaWYgKGJ1dHRvbl9kaXYpIHtcbiAgICAgICAgLy9DaGFuZ2UgdGhlIGNsYXNzIHRvIGFycm93IHZhbmlzaFxuICAgICAgICBidXR0b25fZGl2LmNsYXNzTmFtZSA9ICdhcnJvdyB2YW5pc2gnO1xuICAgIH1cbiAgICBhY2Nlc3NlZF9zb3VyY2VzID0gdHJ1ZVxuICAgIHRpbWVfdG9fYWNjZXNzX3NvdXJjZXMgPSBEYXRlLm5vdygpIC0gdGltZV9xdWVzdGlvbl9zdGFydFxuXG4gICAgLy8kKFwiI2FpX2V4cGxhbmF0aW9uX2Ryb3Bkb3duXCIpLnRvZ2dsZSgpXG4gICAgJChcIiN2aWV3X3NvdXJjZXNfdGl0bGViYXJcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjdmlld19zb3VyY2VzX3RpdGxlYmFyXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbn1cblxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBidXR0b24gY2xpY2tcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3X3NvdXJjZXNfdGl0bGViYXInKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzaG93QWxsU291cmNlcyk7XG5cbmZ1bmN0aW9uIHNob3dTb3VyY2Uoc291cmNlX251bTogbnVtYmVyKSB7XG4gICAgaWYgKHRpbWVfZmluYWxfZGVjaXNpb24gIT0gLTEpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuICAgIFxuICAgIC8vIEdldCB0aGUgZGl2IGVsZW1lbnQgYnkgaXRzIElEXG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHNvdXJjZV8ke3NvdXJjZV9udW19X3NwYW5gKTtcbiAgICBpZiAoZGl2KSB7XG4gICAgICAgIC8vIFRvZ2dsZSB0aGUgdmlzaWJpbGl0eVxuICAgICAgICBkaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuICAgIGNvbnN0IGJ1dHRvbl9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgc291cmNlXyR7c291cmNlX251bX1fZHJvcGJ0bmApO1xuICAgIGlmIChidXR0b25fZGl2KSB7XG4gICAgICAgIC8vQ2hhbmdlIHRoZSBjbGFzcyB0byBhcnJvdyBkb3duXG4gICAgICAgIGJ1dHRvbl9kaXYuY2xhc3NOYW1lID0gJ2Fycm93IGRvd24nO1xuICAgIH1cbiAgICBhY2Nlc3NlZF9pbmRpdmlkdWFsX3NvdXJjZVtzb3VyY2VfbnVtXSA9IHRydWVcbiAgICB0aW1lX3RvX2FjY2Vzc19pbmRpdmlkdWFsX3NvdXJjZVtzb3VyY2VfbnVtXSA9IERhdGUubm93KCkgLSB0aW1lX3F1ZXN0aW9uX3N0YXJ0XG4gICAgLy8kKFwiI2FpX2V4cGxhbmF0aW9uX2Ryb3Bkb3duXCIpLnRvZ2dsZSgpXG4gICAgJChgI3NvdXJjZV8ke3NvdXJjZV9udW19X3RpdGxlYmFyYCkuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoYCNzb3VyY2VfJHtzb3VyY2VfbnVtfV90aXRsZWJhcmApLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbn1cblxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBidXR0b24gY2xpY2tcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfMF90aXRsZWJhcicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNob3dTb3VyY2UoMCkpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV8xX3RpdGxlYmFyJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2hvd1NvdXJjZSgxKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlXzJfdGl0bGViYXInKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzaG93U291cmNlKDIpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfM190aXRsZWJhcicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNob3dTb3VyY2UoMykpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV80X3RpdGxlYmFyJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2hvd1NvdXJjZSg0KSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlXzVfdGl0bGViYXInKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzaG93U291cmNlKDUpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfNl90aXRsZWJhcicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNob3dTb3VyY2UoNikpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV83X3RpdGxlYmFyJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2hvd1NvdXJjZSg3KSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlXzhfdGl0bGViYXInKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzaG93U291cmNlKDgpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfOV90aXRsZWJhcicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNob3dTb3VyY2UoOSkpO1xuXG5mdW5jdGlvbiB1cGRhdGVVc2VyRGVjaXNpb24odXNlcl9kZWNpc2lvbjogYm9vbGVhbikge1xuICAgIGlmIChxdWVzdGlvbl9pICE9IC0xKSB7XG4gICAgICAgIGZpbmFsX3VzZXJfZGVjaXNpb24gPSB1c2VyX2RlY2lzaW9uID8gdHJ1ZSA6IGZhbHNlXG5cbiAgICAgICAgbGV0IGd0X2xhYmVsOiBib29sZWFuID0gcXVlc3Rpb24hW1wiZ3RfbGFiZWxcIl1cbiAgICAgICAgbGV0IHVzZXJfaXNfY29ycmVjdDogYm9vbGVhbiA9IGd0X2xhYmVsID09IGZpbmFsX3VzZXJfZGVjaXNpb25cbiAgICAgICAgaWYgKHVzZXJfaXNfY29ycmVjdCkge1xuICAgICAgICAgICAgYmFsYW5jZSArPSAwLjFcbiAgICAgICAgfVxuICAgICAgICB0aW1lX2ZpbmFsX2RlY2lzaW9uID0gRGF0ZS5ub3coKSAtIHRpbWVfcXVlc3Rpb25fc3RhcnRcblxuICAgICAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX3RpdGxlYmFyXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAgICAgJChcIiN2aWV3X3NvdXJjZXNfdGl0bGViYXJcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICAgICBmb3IgKGxldCBzb3VyY2VfbnVtID0gMDsgc291cmNlX251bSA8IDEwOyBzb3VyY2VfbnVtKyspIHtcbiAgICAgICAgICAgICQoYCNzb3VyY2VfJHtzb3VyY2VfbnVtfV90aXRsZWJhcmApLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAgICAgfVxuXG5cbiAgICAgICAgJChcIiNidXR0b25fbmV4dFwiKS5zaG93KClcbiAgICAgICAgJChcIiNidXR0b25fbmV4dFwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAgICAgJChcIiNidXR0b25fdXNlcl9kZWNpc2lvbl9jbGFpbXRydWVcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICAgICAkKFwiI2J1dHRvbl91c2VyX2RlY2lzaW9uX2NsYWltZmFsc2VcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICAgICBpZiAodXNlcl9kZWNpc2lvbikge1xuICAgICAgICAgICAgZmluYWxfdXNlcl9kZWNpc2lvbiA9IHRydWVcbiAgICAgICAgICAgICQoXCIjYnV0dG9uX3VzZXJfZGVjaXNpb25fY2xhaW10cnVlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZpbmFsX3VzZXJfZGVjaXNpb24gPSBmYWxzZVxuICAgICAgICAgICAgJChcIiNidXR0b25fdXNlcl9kZWNpc2lvbl9jbGFpbWZhbHNlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICAgICAgfVxuXG4gICAgfVxufVxuXG4kKFwiI2J1dHRvbl91c2VyX2RlY2lzaW9uX2NsYWltdHJ1ZVwiKS5vbihcImNsaWNrXCIsICgpID0+IHVwZGF0ZVVzZXJEZWNpc2lvbih0cnVlKSlcbiQoXCIjYnV0dG9uX3VzZXJfZGVjaXNpb25fY2xhaW1mYWxzZVwiKS5vbihcImNsaWNrXCIsICgpID0+IHVwZGF0ZVVzZXJEZWNpc2lvbihmYWxzZSkpXG5cblxuZnVuY3Rpb24gbmV4dF9pbnN0cnVjdGlvbnMoaW5jcmVtZW50OiBudW1iZXIpIHtcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxuXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgfVxuICAgIGlmIChpbnN0cnVjdGlvbl9pID49IDYpIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLnNob3coKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJTdGFydCBzdHVkeVwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiTmV4dFwiKVxuICAgIH1cbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSA3KSB7XG4gICAgICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLmhpZGUoKVxuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuc2hvdygpXG4gICAgICAgIG5leHRfcXVlc3Rpb24oKVxuICAgIH1cblxuICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLmNoaWxkcmVuKFwiOm5vdChpbnB1dClcIikuZWFjaCgoXywgZWwpID0+IHtcbiAgICAgICAgJChlbCkuaGlkZSgpXG4gICAgfSlcbiAgICAkKGAjaW5zdHJ1Y3Rpb25zXyR7aW5zdHJ1Y3Rpb25faX1gKS5zaG93KClcbn1cbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoKzEpKVxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygtMSkpXG5cbiQoXCIjYnV0dG9uX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiB7XG5cbiAgICBpZiAocXVlc3Rpb25faSAhPSAtMSkge1xuICAgICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XG4gICAgICAgICAgICBcInF1ZXN0aW9uX2lcIjogcXVlc3Rpb25faSxcbiAgICAgICAgICAgIFwidXNlcl9iYWxhbmNlX3Bvc3RfaW50ZXJhY3Rpb25cIjogYmFsYW5jZSxcbiAgICAgICAgICAgIFwiZmluYWxfdXNlcl9kZWNpc2lvblwiOiBmaW5hbF91c2VyX2RlY2lzaW9uLFxuICAgICAgICAgICAgXCJhY2Nlc3NlZF9leHBsYW5hdGlvblwiOiBhY2Nlc3NlZF9leHBsYW5hdGlvbixcbiAgICAgICAgICAgIFwiYWNjZXNzZWRfc291cmNlc1wiOiBhY2Nlc3NlZF9zb3VyY2VzLFxuICAgICAgICAgICAgXCJhY2Nlc3NlZF9pbmRpdmlkdWFsX3NvdXJjZVwiOiBhY2Nlc3NlZF9pbmRpdmlkdWFsX3NvdXJjZSxcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2dlZF9kYXRhWyd0aW1lcyddID0ge1xuICAgICAgICAgICAgXCJhY2Nlc3NfZXhwbGFuYXRpb25cIjogdGltZV90b19hY2Nlc3NfZXhwbGFuYXRpb24sXG4gICAgICAgICAgICBcImFjY2Vzc19zb3VyY2VzXCI6IHRpbWVfdG9fYWNjZXNzX3NvdXJjZXMsXG4gICAgICAgICAgICBcImFjY2Vzc19pbmRpdmlkdWFsX3NvdXJjZVwiOiB0aW1lX3RvX2FjY2Vzc19pbmRpdmlkdWFsX3NvdXJjZSxcbiAgICAgICAgICAgIFwiZmluYWxfZGVjaXNpb25cIjogdGltZV9maW5hbF9kZWNpc2lvbixcbiAgICAgICAgfVxuICAgICAgICBsb2dnZWRfZGF0YVsncXVlc3Rpb24nXSA9IHF1ZXN0aW9uXG4gICAgICAgIGxvZ2dlZF9kYXRhWydjb3VudF9leGl0ZWRfcGFnZSddID0gY291bnRfZXhpdGVkX3BhZ2VcbiAgICAgICAgbG9nX2RhdGEobG9nZ2VkX2RhdGEpXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlID0gMFxuICAgIH1cbiAgICBcblxuICAgIG5leHRfcXVlc3Rpb24oKVxufSk7XG5cblxuXG5mdW5jdGlvbiBzaG93X3Jlc3VsdCgpIHtcblxuXG4gICAgLy9sZXQgYWlfaXNfY29ycmVjdDogYm9vbGVhbiA9IHF1ZXN0aW9uIVtcImxsbV9pc19jb3JyZWN0XCJdXG4gICAgLy9sZXQgbWVzc2FnZSA9IFwiQ29ycmVjdCBhbnN3ZXI6IDxiPk9wdGlvbiBcIiArIGNvcnJlY3Rfb3B0aW9uICsgXCI8L2I+Ljxicj5cIlxuICAgIC8vaWYgKHVzZXJfaXNfY29ycmVjdCkge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gXCJZb3UgcGlja2VkIE9wdGlvbiBcIiArIGZpbmFsX3VzZXJfZGVjaXNpb24gKyBcIiwgd2hpY2ggd2FzIDxzcGFuIGNsYXNzPSdjb2xvcl9jb3JyZWN0Jz48Yj5jb3JyZWN0PC9iPjwvc3Bhbj4uPGJyPlwiXG4gICAgLy99XG4gICAgLy9lbHNlIHtcbiAgICAvLyAgICBtZXNzYWdlICs9IFwiWW91IHBpY2tlZCBPcHRpb24gXCIgKyBmaW5hbF91c2VyX2RlY2lzaW9uICsgXCIsIHdoaWNoIHdhcyA8c3BhbiBjbGFzcz0nY29sb3JfaW5jb3JyZWN0Jz48Yj5pbmNvcnJlY3Q8L2I+PC9zcGFuPi48YnI+XCJcbiAgICAvL31cbiAgICAvL2lmIChhaV9pc19jb3JyZWN0KSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBcIlRoZSBBSSBwaWNrZWQgT3B0aW9uIFwiICsgcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSArIFwiLCB3aGljaCB3YXMgPHNwYW4gY2xhc3M9J2NvbG9yX2NvcnJlY3QnPjxiPmNvcnJlY3Q8Yj48L3NwYW4+Ljxicj5cIlxuICAgIC8vfVxuICAgIC8vZWxzZSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBcIlRoZSBBSSBwaWNrZWQgT3B0aW9uIFwiICsgcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSArIFwiLCB3aGljaCB3YXMgPHNwYW4gY2xhc3M9J2NvbG9yX2luY29ycmVjdCc+PGI+aW5jb3JyZWN0PC9iPjwvc3Bhbj4uPGJyPlwiXG4gICAgLy99XG4gICAgLy9pZiAodXNlcl9pc19jb3JyZWN0KSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBcIjxzcGFuIGNsYXNzPSdjb2xvcl9jb3JyZWN0Jz48Yj5Zb3UgcmVjZWl2ZSBhIHJld2FyZCBvZiAkMC4xMC48L2I+PC9zcGFuPlwiXG4gICAgLy8gICAgYmFsYW5jZSArPSAwLjFcbiAgICAvL31cbiAgICAvL2Vsc2Uge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gXCI8c3BhbiBjbGFzcz0nY29sb3JfaW5jb3JyZWN0Jz48Yj5Zb3UgZG8gbm90IHJlY2VpdmUgYW55IHJld2FyZC48L2I+PC9zcGFuPlwiXG4gICAgLy99XG4gICAgLy9tZXNzYWdlICs9IFwiPGJyPlwiXG4gICAgLy9pZiAoc3VjY2Vzcykge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gYFlvdSBnYWluICQkeyhiZXRfdmFsKmJldF92YWxfcmF0aW8pLnRvRml4ZWQoMil9LmBcbiAgICAvLyAgICBiYWxhbmNlICs9IGJldF92YWwqYmV0X3ZhbF9yYXRpb1xuICAgIC8vfSBlbHNlIHtcbiAgICAvLyAgICBtZXNzYWdlICs9IGBZb3UgbG9zZSAkJHsoYmV0X3ZhbC8xLjApLnRvRml4ZWQoMil9LmBcbiAgICAvLyAgICBiYWxhbmNlIC09IGJldF92YWwvMS4wXG4gICAgLy8gICAgYmFsYW5jZSA9IE1hdGgubWF4KDAsIGJhbGFuY2UpXG4gICAgLy99XG4gICAgLy8kKFwiI2JhbGFuY2VcIikudGV4dChgQmFsYW5jZTogJCR7YmFsYW5jZS50b0ZpeGVkKDIpfSArICQxLjBgKVxuICAgIC8vJChcIiNyZXN1bHRfc3BhblwiKS5odG1sKG1lc3NhZ2UpXG4gICAgLy8vLyQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpXG4gICAgLy8kKFwiI3Jlc3VsdF9zcGFuXCIpLnNob3coKVxuICAgIC8vJChcIiNidXR0b25fcGxhY2VfYmV0XCIpLmhpZGUoKVxuXG4gICAgLy8kKCcjcmFuZ2VfdmFsJykuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxufVxuXG4vLyQoXCIjYnV0dG9uX3BsYWNlX2JldFwiKS5vbihcImNsaWNrXCIsIHNob3dfcmVzdWx0KVxuXG5mdW5jdGlvbiBuZXh0X3F1ZXN0aW9uKCkge1xuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcblxuICAgICQoXCIjYnV0dG9uX3VzZXJfZGVjaXNpb25fY2xhaW10cnVlXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3VzZXJfZGVjaXNpb25fY2xhaW1mYWxzZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl91c2VyX2RlY2lzaW9uX2NsYWltdHJ1ZVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl91c2VyX2RlY2lzaW9uX2NsYWltZmFsc2VcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG5cbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2Ryb3BidG5cIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9kcm9wYnRuXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fZHJvcGJ0blwiKS5hdHRyKFwiY2xhc3NcIiwgXCJhcnJvdyByaWdodFwiKVxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fdGl0bGViYXJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl90aXRsZWJhclwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2Ryb3Bkb3duXCIpLmhpZGUoKVxuXG4gICAgJChcIiN2aWV3X3NvdXJjZXNfZHJvcGJ0blwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI3ZpZXdfc291cmNlc19kcm9wYnRuXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjdmlld19zb3VyY2VzX2Ryb3BidG5cIikuYXR0cihcImNsYXNzXCIsIFwiYXJyb3cgcmlnaHRcIilcbiAgICAkKFwiI3ZpZXdfc291cmNlc190aXRsZWJhclwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI3ZpZXdfc291cmNlc190aXRsZWJhclwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2FsbF9zb3VyY2VzX2RpdlwiKS5oaWRlKClcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICAkKGAjc291cmNlXyR7aX1fc3BhbmApLmhpZGUoKVxuICAgICAgICAkKGAjc291cmNlXyR7aX1fZHJvcGJ0bmApLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICAgICAkKGAjc291cmNlXyR7aX1fZHJvcGJ0bmApLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICAgICAkKGAjc291cmNlXyR7aX1fZHJvcGJ0bmApLmF0dHIoXCJjbGFzc1wiLCBcImFycm93IHJpZ2h0XCIpXG4gICAgICAgICQoYCNzb3VyY2VfJHtpfV90aXRsZWJhcmApLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICAgICAkKGAjc291cmNlXyR7aX1fdGl0bGViYXJgKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICB9XG5cbiAgICBhY2Nlc3NlZF9leHBsYW5hdGlvbiA9IGZhbHNlXG4gICAgYWNjZXNzZWRfc291cmNlcyA9IGZhbHNlXG4gICAgYWNjZXNzZWRfaW5kaXZpZHVhbF9zb3VyY2UgPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdXG5cbiAgICB0aW1lX3RvX2FjY2Vzc19leHBsYW5hdGlvbiA9IC0xXG4gICAgdGltZV90b19hY2Nlc3Nfc291cmNlcyA9IC0xXG4gICAgdGltZV90b19hY2Nlc3NfaW5kaXZpZHVhbF9zb3VyY2UgPSBbLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTFdXG4gICAgdGltZV9maW5hbF9kZWNpc2lvbiA9IC0xXG4gICAgXG5cbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxuICAgIC8vJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfdHJ1c3QpXG5cbiAgICBxdWVzdGlvbl9pICs9IDFcbiAgICBpZiAocXVlc3Rpb25faSA+PSBkYXRhLmxlbmd0aCkge1xuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpXG4gICAgICAgIGlmIChNT0NLTU9ERSkge1xuICAgICAgICAgICAgJChcIiNtYWluX2JveF9lbmRfbW9ja1wiKS5zaG93KClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoXCIjbWFpbl9ib3hfZW5kXCIpLnNob3coKVxuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBxdWVzdGlvbiA9IGRhdGFbcXVlc3Rpb25faV1cblxuICAgICQoXCIjY2xhaW1fc3BhblwiKS5odG1sKHF1ZXN0aW9uIVtcImNsYWltXCJdKVxuICAgIGxldCBhaV9wcmVkaWN0aW9uID0gcXVlc3Rpb24hW1wibGxtX3ByZWRpY3Rpb25cIl0gPyBcIlRoZSBjbGFpbSBpcyB0cnVlLlwiIDogXCJUaGUgY2xhaW0gaXMgZmFsc2UuXCJcbiAgICAkKFwiI2FpX3ByZWRpY3Rpb25fc3BhblwiKS5odG1sKGFpX3ByZWRpY3Rpb24pXG4gICAgJChcIiNhaV9jb25maWRlbmNlX3NwYW5cIikuaHRtbChxdWVzdGlvbiFbXCJsbG1fY29uZmlkZW5jZVwiXSlcblxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fc3BhblwiKS5odG1sKHF1ZXN0aW9uIVtcImxsbV9leHBsYW5hdGlvblwiXSlcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHF1ZXN0aW9uIVtcInNvdXJjZXNcIl0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgJChgI3NvdXJjZV8ke2l9X3NwYW5gKS5odG1sKHF1ZXN0aW9uIVtcInNvdXJjZXNcIl1baV0pXG4gICAgfVxuXG4gICAgLy8gc2V0IGJldCB2YWx1ZSByYXRpb1xuICAgIC8vaWYocXVlc3Rpb24uaGFzT3duUHJvcGVydHkoXCJyZXdhcmRfcmF0aW9cIikpIHtcbiAgICAvLyAgICBsZXQgW3JhdGlvMSwgcmF0aW8yXSA9IHF1ZXN0aW9uW1wicmV3YXJkX3JhdGlvXCJdXG4gICAgLy8gICAgcmF0aW8xID0gTnVtYmVyKHJhdGlvMSlcbiAgICAvLyAgICByYXRpbzIgPSBOdW1iZXIocmF0aW8yKVxuICAgIC8vICAgIGJldF92YWxfcmF0aW8gPSByYXRpbzEvcmF0aW8yXG4gICAgLy99IGVsc2Uge1xuICAgIC8vICAgIGJldF92YWxfcmF0aW8gPSAxXG4gICAgLy99XG5cbiAgICB0aW1lX3F1ZXN0aW9uX3N0YXJ0ID0gRGF0ZS5ub3coKVxuICAgICQoXCIjcHJvZ3Jlc3NcIikudGV4dChgUHJvZ3Jlc3M6ICR7cXVlc3Rpb25faSArIDF9IC8gJHtkYXRhLmxlbmd0aH1gKVxufVxuXG4vLyBnZXQgdXNlciBpZCBhbmQgbG9hZCBxdWV1ZVxuLy8gdHJ5IHRvIHNlZSBpZiBzdGFydCBvdmVycmlkZSB3YXMgcGFzc2VkXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuY29uc3Qgc3RhcnRPdmVycmlkZSA9IHVybFBhcmFtcy5nZXQoJ3N0YXJ0Jyk7XG5jb25zdCBVSURGcm9tVVJMID0gdXJsUGFyYW1zLmdldChcInVpZFwiKVxuZ2xvYmFsVGhpcy51cmxfZGF0YSA9IHBhcmFtc1RvT2JqZWN0KHVybFBhcmFtcy5lbnRyaWVzKCkpXG5cbmlmIChVSURGcm9tVVJMICE9IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFVJREZyb21VUkwgYXMgc3RyaW5nXG4gICAgaWYgKGdsb2JhbFRoaXMudWlkID09IFwicHJvbGlmaWNfcmFuZG9tXCIpIHtcbiAgICAgICAgbGV0IHF1ZXVlX2lkID0gYCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApfWAucGFkU3RhcnQoMywgXCIwXCIpXG4gICAgICAgIGdsb2JhbFRoaXMudWlkID0gYCR7dXJsUGFyYW1zLmdldChcInByb2xpZmljX3F1ZXVlX25hbWVcIil9XyR7cXVldWVfaWR9YFxuICAgIH1cbn0gZWxzZSBpZiAoREVWTU9ERSkge1xuICAgIGdsb2JhbFRoaXMudWlkID0gXCJkZW1vXCJcbn0gZWxzZSB7XG4gICAgbGV0IFVJRF9tYXliZTogYW55ID0gbnVsbFxuICAgIHdoaWxlIChVSURfbWF5YmUgPT0gbnVsbCkge1xuICAgICAgICBVSURfbWF5YmUgPSBwcm9tcHQoXCJFbnRlciB5b3VyIHVzZXIgaWQuIFBsZWFzZSBnZXQgaW4gdG91Y2ggaWYgeW91IHdlcmUgbm90IGFzc2lnbmVkIGFuIGlkIGJ1dCB3aXNoIHRvIHBhcnRpY2lwYXRlIGluIHRoaXMgZXhwZXJpbWVudC5cIilcbiAgICB9XG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURfbWF5YmUhXG59XG5cbi8vIHZlcnNpb24gZm9yIHBhcGVyXG5pZiAoZ2xvYmFsVGhpcy51aWQuc3RhcnRzV2l0aChcImRlbW9fcGFwZXJcIikpIHtcbiAgICBNT0NLTU9ERSA9IHRydWVcbn0gZWxzZSB7XG5cbn1cbmNvbnNvbGUubG9nKFwiUnVubmluZyB3aXRoIFVJRFwiLCBnbG9iYWxUaGlzLnVpZClcbmxvYWRfZGF0YSgpLmNhdGNoKChfZXJyb3IpID0+IHtcbiAgICAvL2FsZXJ0KFwiSW52YWxpZCB1c2VyIGlkLlwiKVxuICAgIGNvbnNvbGUubG9nKFwiSW52YWxpZCB1c2VyIGlkLlwiKVxuICAgIGNvbnNvbGUubG9nKGdsb2JhbFRoaXMudWlkISlcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbn1cbikudGhlbigobmV3X2RhdGEpID0+IHtcbiAgICBkYXRhID0gbmV3X2RhdGFcbiAgICBpZiAoc3RhcnRPdmVycmlkZSAhPSBudWxsKSB7XG4gICAgICAgIHF1ZXN0aW9uX2kgPSBwYXJzZUludChzdGFydE92ZXJyaWRlKSAtIDFcbiAgICAgICAgY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIHF1ZXN0aW9uX2kpXG4gICAgfVxuICAgIC8vIG5leHRfcXVlc3Rpb24oKVxuICAgIG5leHRfaW5zdHJ1Y3Rpb25zKDApXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpXG4gICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxufSlcblxuY29uc29sZS5sb2coXCJTdGFydGluZyBzZXNzaW9uIHdpdGggVUlEOlwiLCBnbG9iYWxUaGlzLnVpZCEpXG5cbmxldCBhbGVydF9hY3RpdmUgPSBmYWxzZVxuZG9jdW1lbnQub252aXNpYmlsaXR5Y2hhbmdlID0gKCkgPT4ge1xuICAgIGlmICghYWxlcnRfYWN0aXZlKSB7XG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlICs9IDFcbiAgICAgICAgYWxlcnRfYWN0aXZlID0gdHJ1ZVxuICAgICAgICAvL2lmICghKGdsb2JhbFRoaXMudWlkIS5zdGFydHNXaXRoKFwiZGVtb1wiKSkpIHtcbiAgICAgICAgLy8gICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXG4gICAgICAgIC8vfVxuICAgICAgICBhbGVydF9hY3RpdmUgPSBmYWxzZVxuICAgIH1cbn0iLCJmdW5jdGlvbiBwYXJhbXNUb09iamVjdChlbnRyaWVzKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHt9XG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgZW50cmllcykge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IHsgcGFyYW1zVG9PYmplY3QgfSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlNFUlZFUl9MT0dfUk9PVCIsIk1PQ0tNT0RFIiwiZGF0YSIsImZpbmFsX3VzZXJfZGVjaXNpb24iLCJ0aW1lX3F1ZXN0aW9uX3N0YXJ0IiwicXVlc3Rpb25faSIsInF1ZXN0aW9uIiwiYWNjZXNzZWRfZXhwbGFuYXRpb24iLCJhY2Nlc3NlZF9zb3VyY2VzIiwiYWNjZXNzZWRfaW5kaXZpZHVhbF9zb3VyY2UiLCJiYWxhbmNlIiwidGltZV90b19hY2Nlc3NfZXhwbGFuYXRpb24iLCJ0aW1lX3RvX2FjY2Vzc19zb3VyY2VzIiwidGltZV90b19hY2Nlc3NfaW5kaXZpZHVhbF9zb3VyY2UiLCJ0aW1lX2ZpbmFsX2RlY2lzaW9uIiwiaW5zdHJ1Y3Rpb25faSIsImNvdW50X2V4aXRlZF9wYWdlIiwic2hvd1NvdXJjZSIsInNvdXJjZV9udW0iLCJkaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJkaXNwbGF5IiwiYnV0dG9uX2RpdiIsImNsYXNzTmFtZSIsIkRhdGUiLCJub3ciLCIkIiwiYXR0ciIsInVwZGF0ZVVzZXJEZWNpc2lvbiIsInVzZXJfZGVjaXNpb24iLCJzaG93IiwicmVtb3ZlQXR0ciIsIm5leHRfaW5zdHJ1Y3Rpb25zIiwiaW5jcmVtZW50IiwidmFsIiwiaGlkZSIsIm5leHRfcXVlc3Rpb24iLCJjaGlsZHJlbiIsImVhY2giLCJfIiwiZWwiLCJpIiwibGVuZ3RoIiwiaHRtbCIsImFpX3ByZWRpY3Rpb24iLCJ0ZXh0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uIiwibG9nZ2VkX2RhdGEiLCJhc3luYyIsImNvbnNvbGUiLCJsb2ciLCJnbG9iYWxUaGlzIiwidXJsX2RhdGEiLCJ1aWQiLCJyZXN1bHQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJwYXlsb2FkIiwidHlwZSIsImNvbnRlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2xlZXAiLCJlIiwibG9nX2RhdGEiLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN0YXJ0T3ZlcnJpZGUiLCJVSURGcm9tVVJMIiwiZW50cmllcyIsInZhbHVlIiwicGFyYW1zVG9PYmplY3QiLCJxdWV1ZV9pZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInBhZFN0YXJ0IiwiVUlEX21heWJlIiwicHJvbXB0Iiwic3RhcnRzV2l0aCIsImdldEpTT04iLCJsb2FkX2RhdGEiLCJjYXRjaCIsIl9lcnJvciIsInJlbG9hZCIsInRoZW4iLCJuZXdfZGF0YSIsInBhcnNlSW50IiwiYWxlcnRfYWN0aXZlIiwib252aXNpYmlsaXR5Y2hhbmdlIl0sInNvdXJjZVJvb3QiOiIifQ==